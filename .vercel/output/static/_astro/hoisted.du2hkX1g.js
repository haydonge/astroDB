import"./Dialog2stock.astro_astro_type_script_index_0_lang.dHQqSch7.js";document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-delete]").forEach(e=>{e.addEventListener("click",async t=>{const r=e.getAttribute("data-id");try{await fetch(`/api/${r}.json`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),e.closest("article").remove(),console.log("deleted")}catch(a){console.error(a)}})});const s=document.querySelectorAll("[data-update]"),o=document.getElementById("dialog2");s.forEach(e=>{e.addEventListener("click",t=>{const r={id:e.getAttribute("data-id"),partnumber:e.getAttribute("data-partnumber"),description:e.getAttribute("data-description"),qty:e.getAttribute("data-qty"),url:e.getAttribute("data-url"),safeqty:e.getAttribute("data-safeqty")};if(o){const a=o.querySelector("form");a.querySelector("[name='id']").value=r.id,a.querySelector("[name='partnumber']").value=r.partnumber,a.querySelector("[name='description']").value=r.description,a.querySelector("[name='qty']").value=r.qty,a.querySelector("[name='url']").value=r.url,a.querySelector("[name='safeqty']").value=r.safeqty,o.showModal()}})})});document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("update-form"),s=document.getElementById("close-dialog"),o=document.getElementById("dialog2");if(!n||!s||!o){console.error("One or more elements are missing");return}s.addEventListener("click",()=>o.close()),o.addEventListener("click",e=>{e.target===e.currentTarget&&o.close()}),n.addEventListener("submit",async e=>{e.preventDefault();try{const t=new FormData(n),r={id:t.get("id"),partnumber:t.get("partnumber"),description:t.get("description"),qty:t.get("qty"),url:t.get("url"),safeqty:t.get("safeqty")},c=await(await fetch(`/api/${r.id}.json`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();if(c.success)o.close(),location.reload();else throw new Error(c.message)}catch(t){t instanceof Error?alert(t.message):console.error("An unknown error occurred:",t)}})});
