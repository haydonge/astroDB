import"./Dialog2stock.astro_astro_type_script_index_0_lang.dHQqSch7.js";document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-delete]").forEach(e=>{e.addEventListener("click",async r=>{const a=e.getAttribute("data-id");try{await fetch(`/api/${a}.json`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),e.closest("article").remove(),console.log("deleted")}catch(n){console.error(n)}})});const c=document.querySelectorAll("[data-update]"),t=document.getElementById("dialog2");c.forEach(e=>{e.addEventListener("click",r=>{const a={id:e.getAttribute("data-id"),partnumber:e.getAttribute("data-partnumber"),description:e.getAttribute("data-description"),qty:e.getAttribute("data-qty"),url:e.getAttribute("data-url"),safeqty:e.getAttribute("data-safeqty")};if(t){const n=t.querySelector("form");n.querySelector("[name='id']").value=a.id,n.querySelector("[name='partnumber']").value=a.partnumber,n.querySelector("[name='description']").value=a.description,n.querySelector("[name='qty']").value=a.qty,n.querySelector("[name='url']").value=a.url,n.querySelector("[name='safeqty']").value=a.safeqty,t.showModal()}})})});const s=document.querySelectorAll("[data-delete]");s.forEach(o=>{o.addEventListener("click",async c=>{const t=o.getAttribute("data-id");try{await fetch(`/api/${t}.json`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),console.log("deleted"),o.closest("tr")?.remove()}catch(e){console.error(e)}})});const l=document.querySelectorAll("[data-update]");l.forEach(o=>{o.addEventListener("click",async c=>{const t=o.getAttribute("data-id");console.log(t)})});document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("update-form"),c=document.getElementById("close-dialog"),t=document.getElementById("dialog2");if(!o||!c||!t){console.error("One or more elements are missing");return}c.addEventListener("click",()=>t.close()),t.addEventListener("click",e=>{e.target===e.currentTarget&&t.close()}),o.addEventListener("submit",async e=>{e.preventDefault();try{const r=new FormData(o),a={id:r.get("id"),partnumber:r.get("partnumber"),description:r.get("description"),qty:r.get("qty"),url:r.get("url"),safeqty:r.get("safeqty")},d=await(await fetch(`/api/${a.id}.json`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).json();if(d.success)t.close(),location.reload();else throw new Error(d.message)}catch(r){r instanceof Error?alert(r.message):console.error("An unknown error occurred:",r)}})});
